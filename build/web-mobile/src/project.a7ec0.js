require=function c(r,a,s){function l(n,e){if(!a[n]){if(!r[n]){var t="function"==typeof require&&require;if(!e&&t)return t(n,!0);if(p)return p(n,!0);var i=new Error("Cannot find module '"+n+"'");throw i.code="MODULE_NOT_FOUND",i}var o=a[n]={exports:{}};r[n][0].call(o.exports,function(e){var t=r[n][1][e];return l(t||e)},o,o.exports,c,r,a,s)}return a[n].exports}for(var p="function"==typeof require&&require,e=0;e<s.length;e++)l(s[e]);return l}({Ctype:[function(e,t,n){"use strict";cc._RF.push(t,"cf26bf/kz1CDrnMVgi5+OUc","Ctype");t.exports={auth:{LOGIN_REQ:65537,LOGIN_RES:65538,EDIT_PROFILE:65539,UNAME_LOGIN:65542}},cc._RF.pop()},{}],chooseSite:[function(e,t,n){"use strict";cc._RF.push(t,"80259f5GOVDl6InUc8MB46V","chooseSite");var i=e("globel");cc.Class({extends:cc.Component,properties:{yuleSite:{type:cc.Node,default:null},fiveHairSite:{type:cc.Node,default:null},OneYuanSite:{type:cc.Node,default:null},chooseNumber:0,tipPrefab:{type:cc.Prefab,default:null}},onLoad:function(){cc.director.preloadScene("gameScene"),this.yuleSite.on("touchstart",function(){i.siteNum=1,cc.director.loadScene("gameScene")}),this.fiveHairSite.on("touchstart",function(){cc.director.loadScene("gameScene"),i.siteNum=2}),this.OneYuanSite.on("touchstart",function(){cc.director.loadScene("gameScene"),i.siteNum=3})},error:function(){var e=cc.instantiate(this.tipPrefab);this.node.addChild(e);e.getComponent("error_tip").tipLabelChange("暂未开放，敬请期待！")},start:function(){}}),cc._RF.pop()},{globel:"globel"}],clipCollider:[function(e,t,n){"use strict";cc._RF.push(t,"9e1ad9hFjNC7LCBOl3ecerH","clipCollider");var l=e("globel"),i=cc.Class({name:"prop",properties:{id:0,itemName:"",iconSF:cc.SpriteFrame}});cc.Class({extends:cc.Component,properties:{pigPrefab:{type:cc.Prefab,default:null},pandaPrefab:{type:cc.Prefab,default:null},bearPrefab:{type:cc.Prefab,default:null},clipdollsRoot:{type:cc.Node,default:null},bg_bottom0:{type:cc.Node,default:null},bg_bottom1:{type:cc.Node,default:null},ToolsSpriteFrame:{type:i,default:[]}},onLoad:function(){cc.director.getCollisionManager().enabled=!0},onCollisionEnter:function(r,e){var a=this,t=r.node.children;this.Clipdolls=t[0],this.bg_bottom1.active=!1,this.bg_bottom0.active=!0,this.Clipdolls.parent=this.clipdollsRoot;var s=this.Clipdolls.children[0].name,n=this.Clipdolls.children[0];switch(s){case"brand":this.prizeName=n.getChildByName("prizeName").getComponent(cc.Label).string;break;case"gold":this.prizeName=n.getChildByName("goldNum").getComponent(cc.Label).string;break;case"wallet":this.prizeName=n.getChildByName("bean").getComponent(cc.Label).string}l.prizeName=this.prizeName,this.scheduleOnce(function(){if(1==l.siteNum)var e=cc.instantiate(this.pigPrefab);else if(2==l.siteNum)e=cc.instantiate(this.pandaPrefab);else if(3==l.siteNum)e=cc.instantiate(this.bearPrefab);r.node.addChild(e);var t=r.node.children[0],n=t.getChildByName("brand"),i=t.getChildByName("wallet"),o=t.getChildByName("gold");switch(s){case"brand":for(var c in i.destroy(),o.destroy(),a.ToolsSpriteFrame)a.prizeName==a.ToolsSpriteFrame[c].itemName&&(n.children[0].getComponent(cc.Sprite).spriteFrame=a.ToolsSpriteFrame[c].iconSF,n.children[1].getComponent(cc.Label).string=a.ToolsSpriteFrame[c].itemName);break;case"gold":i.destroy(),n.destroy(),o.children[0].getComponent(cc.Label).string=a.prizeName;break;case"wallet":n.destroy(),o.destroy(),i.children[0].getComponent(cc.Label).string=a.prizeName}r.node.active=!1},3),this.scheduleOnce(function(){r.node.active=!0},7)},start:function(){}}),cc._RF.pop()},{globel:"globel"}],dollsCollider:[function(e,t,n){"use strict";cc._RF.push(t,"ad743oGuHhNDKw0pJ+dJ79o","dollsCollider");var i=e("http"),p=e("globel"),o=cc.Class({name:"tool",properties:{id:0,itemName:"",iconSF:cc.SpriteFrame}});cc.Class({extends:cc.Component,properties:{playerlist:{type:cc.Node,default:null},isCollider:!1,ToolsSpriteFrame:{type:o,default:[]},pigPrefab:{type:cc.Prefab,default:null},pandaPrefab:{type:cc.Prefab,default:null},bearPrefab:{type:cc.Prefab,default:null},direction:""},onLoad:function(){cc.director.getCollisionManager().enabled=!0,this.getData(),"right"==this.direction&&(this.typeCount=10),"left"==this.direction&&(this.typeCount=15)},onCollisionEnter:function(e,t){if(this.isCollider=!0,this.other=e,this.typeCount++,this.typeCount<=this.typeArr.length){var n=this.typeArr[this.typeCount-1],i=this.other.node.children[0];switch(null!=i&&i.removeFromParent(),p.siteNum){case 1:var o=cc.instantiate(this.pigPrefab);break;case 2:o=cc.instantiate(this.pandaPrefab);break;case 3:o=cc.instantiate(this.bearPrefab)}this.other.node.addChild(o);var c=this.other.node.children[0],r=c.getChildByName("brand"),a=c.getChildByName("wallet"),s=c.getChildByName("gold");switch(n[0]){case"gift":for(var l in a.destroy(),s.destroy(),this.ToolsSpriteFrame)r.children[0].getComponent(cc.Sprite).spriteFrame=this.ToolsSpriteFrame[l].iconSF,r.children[1].getComponent(cc.Label).string=this.typeArr[this.typeCount-1][1].name;break;case"gold":r.destroy(),s.destroy(),a.children[0].getComponent(cc.Label).string=this.listdata[0].children[this.typeCount-1].name;break;case"zhuanshi":r.destroy(),a.destroy(),s.children[0].getComponent(cc.Label).string=this.listdata[0].children[this.typeCount-1].name}this.typeCount==this.typeArr.length&&(console.log("我遍历完了"),this.typeCount=0)}},getData:function(){i.get("http://127.0.0.1:3000/gifts.json",function(e,t){if(t)console.log(t);else for(var n in this.list_data=JSON.parse(e),this.listdata=this.list_data,this.typeArr=[],this.listdata)for(var i in this.listdata[n]){this.typeArr.push(["gift",this.listdata[n][i]])}}.bind(this))},start:function(){},update:function(e){this.isCollider&&("right"==this.direction&&(this.other.node.x=-590),"left"==this.direction&&(this.other.node.x=-630))}}),cc._RF.pop()},{globel:"globel",http:"http"}],dollsMove:[function(e,t,n){"use strict";cc._RF.push(t,"74d9cFJM8xLSb1gl4aOnhwV","dollsMove");var i=e("http"),c=e("globel"),o=cc.Class({name:"tools",properties:{id:0,itemName:"",iconSF:cc.SpriteFrame}});cc.Class({extends:cc.Component,properties:{speed:0,dollList:{type:cc.Node,default:null},reverseList:{type:cc.Node,default:null},pigPrefab:{type:cc.Prefab,default:null},pandaPrefab:{type:cc.Prefab,default:null},bearPrefab:{type:cc.Prefab,default:null},ToolsSpriteFrame:{type:o,default:[]}},onLoad:function(){this.playerlist(),this.replayerlist()},playerlist:function(){var e=this.dollList;this.getData(e)},replayerlist:function(){var e=this.reverseList;this.getData(e)},getData:function(o){i.get("http://127.0.0.1:3000/gifts.json",function(e,t){if(t)console.log(t);else{for(var n in this.listdata=JSON.parse(e),this.typeArr=[],this.listdata)for(var i in this.listdata[n]){this.typeArr.push(["gift",this.listdata[n][i]])}this.dollsinit(o)}}.bind(this))},dollsinit:function(e){for(var t=0;t<e.children.length;t++){switch(c.siteNum){case 1:var n=cc.instantiate(this.pigPrefab);break;case 2:n=cc.instantiate(this.pandaPrefab);break;case 3:n=cc.instantiate(this.bearPrefab)}e.children[t].addChild(n);var i=this.typeArr[t],o=e.children[t].children[0];this.dollsSkin(e,o,i,t)}},dollsSkin:function(e,t,n,i){var o=t.getChildByName("brand"),c=t.getChildByName("wallet"),r=t.getChildByName("gold");switch(n[0]){case"gift":for(var a in c.destroy(),r.destroy(),this.ToolsSpriteFrame)o.children[0].getComponent(cc.Sprite).spriteFrame=this.ToolsSpriteFrame[a].iconSF,o.children[1].getComponent(cc.Label).string=this.typeArr[i][1].name;break;case"gold":o.destroy(),r.destroy(),c.children[0].getComponent(cc.Label).string=this.listdata[0].children[i].name;break;case"zhuanshi":o.destroy(),c.destroy(),r.children[0].getComponent(cc.Label).string=this.listdata[0].children[i].name}},start:function(){},update:function(e){this.speed=100;for(var t=this.speed*e,n=0;n<this.dollList.children.length;n++)this.dollList.children[n].x+=t;for(var i=0;i<this.reverseList.children.length;i++)this.reverseList.children[i].x-=t}}),cc._RF.pop()},{globel:"globel",http:"http"}],error_tip:[function(e,t,n){"use strict";cc._RF.push(t,"1bcdeN9sqVMZZ2Zl5M6HfrD","error_tip"),cc.Class({extends:cc.Component,properties:{dialog_root:{type:cc.Node,default:null},mask:{type:cc.Node,default:null},tip_dialog:{type:cc.Node,default:null},tipLabel:cc.Label},onLoad:function(){this.dialog_show()},tipLabelChange:function(e){this.tipLabel.string=e},dialog_show:function(){var e=cc.fadeTo(.3,128);this.mask.runAction(e),this.dialog_root.active=!0,this.tip_dialog.scale=0;var t=cc.scaleTo(.3,1).easing(cc.easeBackOut());this.tip_dialog.runAction(t)},dialog_hide:function(){var e=this,t=cc.fadeOut(.3);this.mask.runAction(t);var n=cc.scaleTo(.3,0).easing(cc.easeBackIn()),i=cc.callFunc(function(){e.dialog_root.active=!1}),o=cc.sequence(n,i);this.tip_dialog.runAction(o)},start:function(){}}),cc._RF.pop()},{}],extend:[function(e,t,n){"use strict";cc._RF.push(t,"a9ba2Z0/mBLB4h/ta2bhcbR","extend"),DataView.prototype.writeUTF8Str=function(e,t){for(var n=e,i=this,o=0;o<t.length;o++){var c=t.charCodeAt(o);c<128?i.setUint8(n,c):(c<2048?i.setUint8(n,192|c>>6):(c<55296||57344<=c?i.setUint8(n,224|c>>12):(o++,c=65536+((1023&c)<<10|1023&t.charCodeAt(o)),i.setUint8(n,240|c>>18),n++,i.setUint8(n,128|c>>12&63)),n++,i.setUint8(n,128|c>>6&63)),n++,i.setUint8(n,128|63&c)),n++}},DataView.prototype.readUTF8Str=function(e,t){var n,i,o,c,r,a;for(n="",o=e+t,i=e;i<o;)switch(c=this.getUint8(i),i++,c>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:n+=String.fromCharCode(c);break;case 12:case 13:r=array[i++],n+=String.fromCharCode((31&c)<<6|63&r);break;case 14:r=this.getUint8(i),i++,a=this.getUint8(i),i++,n+=String.fromCharCode((15&c)<<12|(63&r)<<6|(63&a)<<0)}return n},String.prototype.utf8StrLength=function(){var e,t,n=0;for(e=0;e<this.length;e++)(t=this.charCodeAt(e))<127?n+=1:128<=t&&t<=2047?n+=2:2048<=t&&t<=65535&&(n+=3);return n},cc._RF.pop()},{}],game:[function(e,t,n){"use strict";cc._RF.push(t,"5fb149WcMtBe73QxLGm6eQb","game");var F=e("globel"),w=e("service");cc.Class({extends:cc.Component,properties:{back:{type:cc.Node,default:null},StartBtn:{type:cc.Node,default:null},clip:{type:cc.Node,default:[]},clipSkin:{type:cc.SpriteFrame,default:[]},rope:{type:cc.Node,default:null},ropeSkin:{type:cc.SpriteFrame,default:[]},tableExit:{type:cc.Node,default:null},pigSkin:{type:cc.SpriteFrame,default:[]},pandaSkin:{type:cc.SpriteFrame,default:[]},bearSkin:{type:cc.SpriteFrame,default:[]},bg_bottom0:{type:cc.Node,default:null},bg_bottom1:{type:cc.Node,default:null},winAlert:{type:cc.Node,default:null},backPage:{type:cc.Node,default:null},branch:{type:cc.Node,default:null},branchLabel:{type:cc.Label,default:null},goldLabel:{type:cc.Label,default:null},energyBar:{type:cc.Node,default:null},win:1,clipTrue:0},winAlertShow:function(){if(this.win){var e=cc.moveTo(1,cc.p(-490,100));this.winAlert.runAction(e)}},onLoad:function(){var k=F.siteNum;cc.game.setFrameRate(30),this.winAlertShow(),this.init(k);var S=this;cc.director.preloadScene("chooseSite"),this.back.on("touchstart",function(){cc.director.loadScene("chooseSite")}),this.StartBtn.on("touchstart",function(){if(S.progressLoad=S.energyBar.getComponent(cc.ProgressBar),S.progressLoad.progress-=.35,!S.is_throwing){S.is_throwing=!0;var e=cc.moveTo(.7,cc.p(0,230)),t=cc.moveTo(.7,cc.p(0,410)),n=cc.moveTo(.7,cc.p(0,480)),i=cc.sequence(e,t,n);S.rope.runAction(i);var o=cc.callFunc(function(){var e=S.clip.getComponent(cc.Animation);1==k?e.play("woodClip"):2==k?e.play("silveryClip"):e.play("goldClip")}),c=cc.moveTo(.7,cc.p(0,-60)),r=130-10*Math.random()+5,a=cc.moveTo(.7,cc.p(0,r)),s=cc.callFunc(function(){var e=S.clip.getComponent(cc.Animation);1==k?e.play("reverseWoodClip"):2==k?e.play("reverseSilveryClip"):e.play("reverseGoldClip")}),l=cc.callFunc(function(){var e=S.clip.getComponent("clipCollider").Clipdolls;if(console.log(F.prizeName),w.clipGifts(F.prizeName),e&&null!=e.getParent())if(S.clipTrue){1==k?e.getComponent(cc.Sprite).spriteFrame=S.pigSkin[0]:2==k?e.getComponent(cc.Sprite).spriteFrame=S.pandaSkin[0]:3==k&&(e.getComponent(cc.Sprite).spriteFrame=S.bearSkin[0]),S.branch.active=!0;var t=S.clip.getComponent("clipCollider").gift;S.branchLabel.getComponent(cc.Label).string=t;var n=S.goldLabel.getComponent(cc.Label).string,i=t+Number(n);S.goldLabel.getComponent(cc.Label).string=i;var o=cc.fadeIn(.1,1),c=cc.moveBy(.5,cc.p(0,50)),r=cc.fadeOut(.1,0),a=cc.moveTo(.5,cc.p(360,285)),s=cc.callFunc(function(){S.branch.active=!1});S.branch.runAction(cc.sequence(o,c,r,a,s));var l=S.backPage.getPosition(),p=cc.delayTime(.1),u=cc.scaleTo(.5,.3),d=cc.moveTo(.7,l.x,150).easing(cc.easeCircleActionInOut()),h=cc.callFunc(function(){e.destroy()}),f=cc.sequence(p,u,d,h);e.runAction(f);var g=cc.delayTime(1.5),y=cc.jumpBy(.5,cc.p(0,0),20,2),b=cc.sequence(g,y);S.backPage.runAction(b)}else{S.tableExit.active=!0,1==k?e.getComponent(cc.Sprite).spriteFrame=S.pigSkin[1]:2==k?e.getComponent(cc.Sprite).spriteFrame=S.pandaSkin[1]:3==k&&(e.getComponent(cc.Sprite).spriteFrame=S.bearSkin[1]);var m=cc.callFunc(function(){S.bg_bottom1.active=!0,S.bg_bottom0.active=!1}),v=cc.moveTo(1,cc.p(0,-475)),C=cc.callFunc(function(){e.removeFromParent(),e.destroy()}),_=cc.sequence(m,v,C);e.runAction(_),S.scheduleOnce(function(){S.tableExit.active=!1},2)}}.bind(this)),p=cc.moveTo(.7,cc.p(0,210)),u=cc.callFunc(function(){S.is_throwing=!1}.bind(this)),d=cc.sequence(o,c,a,l,s,p,u);S.clip.runAction(d)}})},init:function(e){this.rope.getComponent(cc.Sprite).spriteFrame=this.ropeSkin[e-1],this.clip.getComponent(cc.Sprite).spriteFrame=this.clipSkin[e-1]},start:function(){},update:function(e){}}),cc._RF.pop()},{globel:"globel",service:"service"}],globel:[function(e,t,n){"use strict";cc._RF.push(t,"041c1aaG61DjKhSwhXaTRxb","globel"),t.exports={siteNum:1,prizeName:""},cc._RF.pop()},{}],headerInfo:[function(e,t,n){"use strict";cc._RF.push(t,"4fca786PflGEor2beakoFgc","headerInfo");var i=function(){function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}}();var o=function(){function t(e){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,t),e=e||{ctype:0,utag:0,dataType:0},this._stype=0,this._ctype=0,this.ctype=e.ctype?e.ctype:0,this.utag=e.utag?e.utag:0,this.dataType=e.dataType?e.dataType:0}return i(t,[{key:"ctype",get:function(){return this._ctype},set:function(e){this._ctype=e,this._stype=this._ctype>>16}},{key:"stype",get:function(){return this._stype}}]),t}();t.exports=o,cc._RF.pop()},{}],http:[function(e,t,n){"use strict";cc._RF.push(t,"bf0c5KfrIRBy6XO61WLdIr0","http");var i={get:function(e,t){var n=cc.loader.getXMLHttpRequest();n.onreadystatechange=function(){if(4===n.readyState&&200<=n.status&&n.status<300){var e=n.responseText;t(e)}},n.open("GET",e,!0),cc.sys.isNative&&n.setRequestHeader("Accept-Encoding","gzip,deflate"),n.timeout=5e3,n.send()},post:function(e,t,n){var i=cc.loader.getXMLHttpRequest();i.onreadystatechange=function(){if(cc.log("xhr.readyState="+i.readyState+"  xhr.status="+i.status),4===i.readyState&&200<=i.status&&i.status<300){var e=i.responseText;n(e)}else n(-1)},i.open("POST",e,!0),cc.sys.isNative&&i.setRequestHeader("Accept-Encoding","gzip,deflate"),i.timeout=5e3,i.send(t)}};t.exports=i,cc._RF.pop()},{}],loader:[function(e,t,n){"use strict";cc._RF.push(t,"8466buy4fJKW7F51AEMfw7n","loader"),cc.Class({extends:cc.Component,properties:{loaderBar:{type:cc.Node,default:null},progressLabel:{type:cc.Label,default:null}},load:function(){cc.loader.onProgress=function(e,t,n){var i=e/t,o=Math.floor(100*e/t);console.log(t),this.loaderBar.getComponent(cc.ProgressBar).progress=i,this.progressLabel.getComponent(cc.Label).string=o+"%"}.bind(this),cc.director.preloadScene("chooseSite",function(){cc.loader.onpregress=null,cc.director.loadScene("chooseSite")})},onLoad:function(){this.load()},start:function(){}}),cc._RF.pop()},{}],login:[function(e,t,n){"use strict";cc._RF.push(t,"49f83qRqx1LN79b+mbyg4RO","login");var c=e("websocket"),r=e("headerInfo"),a=e("Ctype"),s=e("protoManager"),i={login:function(e,t){var n=new r({ctype:a.auth.LOGIN_REQ,dataType:0}),i={user:e,pwd:t},o=s.encodeJsonMsg(n,i);window.setTimeout(function(){c.send_msg(o)},.1)},login_res:function(e){switch(e){case 0:console.log("用户名或密码错误！")}}};t.exports=i,cc._RF.pop()},{Ctype:"Ctype",headerInfo:"headerInfo",protoManager:"protoManager",websocket:"websocket"}],packageReader:[function(e,t,n){"use strict";cc._RF.push(t,"68c48RhKdROTbUxSichHe83","packageReader");var i=function(){function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}}();var o=function(){function t(e){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,t),this._buf=new DataView(e),this._position=0}return i(t,[{key:"unreadCount",get:function(){return this._unreadCount}},{key:"position",get:function(){return this._position},set:function(e){this._position=e,this._unreadCount=this._buf.length-this.position}}]),i(t,[{key:"readInt8",value:function(){var e=this._buf.getInt8(this.position);return this.position++,e}},{key:"readInt16",value:function(){var e=this._buf.getInt16(this.position);return this.position+=2,e}},{key:"readInt32",value:function(){var e=this._buf.getInt32(this.position);return this.position+=4,e}},{key:"readUInt32",value:function(){var e=this._buf.getUint32(this.position);return this.position+=4,e}},{key:"readUTF8Str",value:function(){var e=this.readInt16(),t=this._buf.readUTF8Str(this.position,e);return this.position+=e,t}}]),t}();t.exports=o,cc._RF.pop()},{}],packageWriter:[function(e,t,n){"use strict";cc._RF.push(t,"c5d62OHnGxAKqXlH/w9Uw7a","packageWriter");var i=function(){function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}}();var o=function(){function t(e){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,t),this._buf=new DataView(e),this._position=0}return i(t,[{key:"unreadCount",get:function(){return this._unreadCount}},{key:"position",get:function(){return this._position},set:function(e){this._position=e,this._unreadCount=this._buf.length-this.position}}]),i(t,[{key:"writeInt8",value:function(e){this._buf.setInt8(this.position,e),this.position++}},{key:"writeInt16",value:function(e){this._buf.setInt16(this.position,e),this.position+=2}},{key:"writeInt32",value:function(e){this._buf.setInt32(this.position,e),this.position+=4}},{key:"writeUInt32",value:function(e){this._buf.setUint32(this.position,e),this.position+=4}},{key:"writeUTF8Str",value:function(e){var t=e.utf8StrLength();this.writeInt16(t),this._buf.writeUTF8Str(this.position,e),this.position+=t}},{key:"writeHeaderInfo",value:function(e){this.writeInt32(e.ctype),this.writeUInt32(e.utag),this.writeInt8(e.dataType)}}],[{key:"writeUtag",value:function(e,t){return e.writeUInt32(t)}},{key:"removeUtag",value:function(e){return e.writeUInt32(0)}}]),t}();o.headerSize=9,t.exports=o,cc._RF.pop()},{}],protoManager:[function(e,t,n){"use strict";cc._RF.push(t,"60b0dqtzsRNOKTzbYc36Yno","protoManager");var i=function(){function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}}();var r=e("packageReader"),a=e("packageWriter"),o=e("headerInfo"),c=function(){function c(){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,c)}return i(c,null,[{key:"readHeaderInfo",value:function(e){if(e.length<9)return null;var t=new r(e),n=new o;return n.ctype=t.readInt32(),n.utag=t.readUInt32(),n.dataType=t.readInt8(),n}},{key:"getKey",value:function(e,t){return 65536*e+t}},{key:"encodeMsg",value:function(e,t){var n=void 0;switch(e.dataType){case 0:case 1:n=c.encodeJsonMsg(e,arrbuffer)}return n}},{key:"decodeMsg",value:function(e,t){var n=void 0;switch(e.dataType){case 0:n=c.decodeJsonMsg(e,t);break;case 1:n=c.encodeBuffMsg(e,t)}return n}},{key:"encodeJsonMsg",value:function(e,t){var n=JSON.stringify(t),i=11+n.utf8StrLength(),o=new ArrayBuffer(i),c=new a(o);return c.writeHeaderInfo(e),c.writeUTF8Str(n),o}},{key:"decodeJsonMsg",value:function(e,t){var n=void 0,i=new r(t);i.position=9;var o=i.readUTF8Str();try{n=JSON.parse(o)}catch(e){console.error("JSON消息解码错误:",e)}return n}},{key:"encodeBuffMsg",value:function(e,t){var n=c.getKey(e.stype,e.ctype),i=c.encoders[n];return i?i(e,t):null}},{key:"decodeBuffMsg",value:function(e,t){var n=new DataView(t),i=c.getKey(e.stype,e.ctype),o=c.decoders[i];return o?(console.log("我在解码buffer"),o(n)):null}},{key:"regEncoder",value:function(e,t,n){var i=c.getKey(e,t);c.encoders[i]&&log.warn("stype: "+e+" ctype: "+t+"the encoder is reged!"),c.encoders[i]=n}},{key:"regDecoder",value:function(e,t,n){var i=c.getKey(e,t);c.decoders[i]&&log.warn("stype: "+e+" ctype: "+t+"the decoder is reged!"),c.decoders[i]=n}},{key:"writeUtag",value:function(e,t){return a.writeUtag(e,t)}},{key:"removeUtag",value:function(e){return a.removeUtag(e)}}]),c}();c.encoders={},c.decoders={},t.exports=c,cc._RF.pop()},{headerInfo:"headerInfo",packageReader:"packageReader",packageWriter:"packageWriter"}],service:[function(e,t,n){"use strict";cc._RF.push(t,"0a5b8B6TkVDxolQxmjB7Pn1","service");var i=e("websocket"),o={clipGifts:function(e){var t={giftname:e};window.setTimeout(function(){i.send_msg(t)},.1)}};t.exports=o,cc._RF.pop()},{websocket:"websocket"}],test_login:[function(e,t,n){"use strict";cc._RF.push(t,"9521bumeipFCb6GHW96pTli","test_login");var i=e("login");cc.Class({extends:cc.Component,properties:{username:cc.EditBox,pwd:cc.EditBox,tipPrefab:{type:cc.Prefab,default:null}},onLoad:function(){},loginCheck:function(){var e=this.username.string,t=this.pwd.string;if(""!=e&&""!=t)i.login(e,t);else{this.show_tip("用户名或密码不能为空")}},show_tip:function(e){var t=cc.instantiate(this.tipPrefab);this.node.addChild(t),t.getComponent("error_tip").tipLabelChange(e)},start:function(){}}),cc._RF.pop()},{login:"login"}],test_socket:[function(e,t,n){"use strict";cc._RF.push(t,"e3b5a5KmjFOirFJf/H2YMPY","test_socket"),cc._RF.pop()},{}],websocket:[function(e,t,n){"use strict";cc._RF.push(t,"895820SAzdAJqavoclCRHFk","websocket");var i=e("protoManager"),o={sock:null,is_connected:!1,receiveDate:null,connect:function(e){this.sock=new WebSocket(e),this.sock.binaryType="arraybuffer",this.sock.onopen=this.on_open.bind(this),this.sock.onmessage=this.on_message.bind(this),this.sock.onerror=this.on_error.bind(this),this.sock.onclose=this.on_close.bind(this)},on_open:function(e){console.log("连接成功"),this.is_connected=!0},on_message:function(e){console.log("我收到信息了");var t=e.data,n=i.readHeaderInfo(t);this.receiveDate=i.decodeMsg(n,t),2==n.ctype&&console.log("我收到的是登录结果:"),console.log(this.receiveDate)},on_error:function(e){this.close()},on_close:function(e){this.sock&&this.close()},close:function(){this.is_connected=!1,null!==this.sock&&(this.sock.close(),this.sock=null)},send_msg:function(e){this.sock&&this.is_connected?(this.sock.send(e),console.log("信息发送成功")):console.log("信息发送失败")}};o.connect("ws://192.168.0.50:7081"),t.exports=o,cc._RF.pop()},{protoManager:"protoManager"}]},{},["extend","chooseSite","loader","dollsCollider","dollsMove","clipCollider","error_tip","game","globel","Ctype","headerInfo","http","packageReader","packageWriter","websocket","protoManager","login","service","test_login","test_socket"]);