{"version":3,"sources":["..\\..\\..\\..\\..\\assets\\Script\\dolls/assets\\Script\\dolls\\dollsCollider.js"],"names":["http","require","globel","tool","cc","Class","name","properties","id","itemName","iconSF","SpriteFrame","extends","Component","playerlist","type","Node","default","isCollider","ToolsSpriteFrame","pigPrefab","Prefab","pandaPrefab","bearPrefab","direction","onLoad","director","getCollisionManager","enabled","typeCount","onCollisionEnter","other","self","typeArr","length","prizeType","oldDolls","node","children","removeFromParent","siteNum","player","instantiate","addChild","dolls","brand","getChildByName","wallet","gold","destroy","getComponent","Sprite","spriteFrame","Label","string","start","update","dt","width","winSize","x"],"mappings":"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","file":"dollsCollider.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\Script\\dolls","sourcesContent":["var http = require(\"http\");\r\n// var url = 'http://vue.sexgz.com/jsonTest/';\r\nvar globel = require(\"globel\");\r\nvar tool = cc.Class({ // 道具\r\n    name: 'tool',\r\n    properties: {\r\n        id: 0,\r\n        itemName: '',\r\n        iconSF: cc.SpriteFrame\r\n    }\r\n});\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        playerlist:{\r\n            type:cc.Node,\r\n            default:null\r\n        },\r\n        isCollider:false,\r\n        ToolsSpriteFrame:{\r\n           type:tool,\r\n           default:[]\r\n        },\r\n        pigPrefab:{\r\n            type:cc.Prefab,\r\n            default:null\r\n        },\r\n        pandaPrefab:{\r\n            type:cc.Prefab,\r\n            default:null\r\n        },\r\n        bearPrefab:{\r\n            type:cc.Prefab,\r\n            default:null\r\n        },\r\n        direction:\"\"\r\n    },\r\n\r\n    // LIFE-CYCLE CALLBACKS:\r\n\r\n    onLoad:function() {\r\n        cc.director.getCollisionManager().enabled = true;\r\n        if(this.direction ==\"right\"){\r\n            this.typeCount = 12;\r\n        }\r\n        if(this.direction ==\"left\"){\r\n            this.typeCount = 17;\r\n        }\r\n    },\r\n    onCollisionEnter:function (other, self) {\r\n        this.isCollider = true; // 碰撞为true\r\n        this.other = other;\r\n        this.typeCount++;\r\n        if(this.typeCount <= globel.typeArr.length){\r\n            let prizeType = globel.typeArr[this.typeCount-1]; // 获取娃娃的数据\r\n            let oldDolls = this.other.node.children[0]; // 原娃娃节点\r\n            if(oldDolls != null){\r\n                oldDolls.removeFromParent();  \r\n            }\r\n            switch(globel.siteNum){ // 根据不同场复制不同预制体\r\n                case 1: var player = cc.instantiate(this.pigPrefab);break;  // 复制预制体\r\n                case 2: var player = cc.instantiate(this.pandaPrefab);break;  // 复制预制体\r\n                case 3: var player = cc.instantiate(this.bearPrefab);break;  // 复制预制体\r\n            }\r\n            this.other.node.addChild(player); // 把预制体加入playerRoot \r\n            let dolls = this.other.node.children[0] // 娃娃节点\r\n            let brand = dolls.getChildByName(\"brand\");       // 礼品节点，放置奖品图          \r\n            let wallet = dolls.getChildByName(\"wallet\");     // 钱包节点，放置金币等\r\n            let gold = dolls.getChildByName(\"gold\");       // 话费节点，放置话费\r\n            switch(prizeType[0]){\r\n                case \"gift\": wallet.destroy(); // 销毁钱包节点\r\n                    gold.destroy(); // 销毁话费节点\r\n                    // for (var g in this.ToolsSpriteFrame){\r\n                        // if(this.typeArr[this.typeCount-1][1].id == this.ToolsSpriteFrame[g].id){\r\n                            // brand.children[0].getComponent(cc.Sprite).spriteFrame = this.ToolsSpriteFrame[g].iconSF;\r\n                            brand.children[0].getComponent(cc.Sprite).spriteFrame = this.ToolsSpriteFrame[0].iconSF;\r\n                            brand.children[1].getComponent(cc.Label).string = globel.typeArr[this.typeCount-1][1].name ;\r\n                            // console.log(this.typeCount,this.typeArr[this.typeCount-1][1].name);\r\n                        // }\r\n                    // }\r\n                    break;\r\n            case \"gold\": brand.destroy();  // 销毁礼品节点\r\n                    gold.destroy(); // 销毁话费节点\r\n                    // wallet.children[0].getComponent(cc.Label).string = this.listdata[0].children[this.typeCount-1].name;\r\n                    break; \r\n            case \"zhuanshi\": brand.destroy();  // 销毁礼品节点\r\n                    wallet.destroy(); // 销毁钱包节点 \r\n                    // gold.children[0].getComponent(cc.Label).string = this.listdata[0].children[this.typeCount-1].name;        \r\n                    break;\r\n            }\r\n         \r\n            if(this.typeCount == globel.typeArr.length){ // 等于最后一个的时候重置为0,重新循环\r\n                this.typeCount = 0;\r\n            }\r\n        }\r\n        \r\n              \r\n    },\r\n    start () {\r\n\r\n    },\r\n\r\n    update:function (dt){\r\n      if(this.isCollider){\r\n          if(this.direction ==\"right\"){\r\n            let width = cc.winSize.width;\r\n            if(width <= 1281){\r\n               this.other.node.x = -810;\r\n            }\r\n            else{\r\n                this.other.node.x = -680;\r\n            }\r\n          }\r\n          if(this.direction ==\"left\"){\r\n            let width = cc.winSize.width;\r\n            if(width <= 1281){\r\n               this.other.node.x = -450;\r\n            }\r\n            else{\r\n                this.other.node.x = -670;\r\n            }\r\n          }\r\n      }\r\n    },\r\n});\r\n"]}