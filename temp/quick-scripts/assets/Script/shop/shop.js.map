{"version":3,"sources":["shop.js"],"names":["global","require","http","url","goldItemImg","cc","Class","name","properties","itemSprite","SpriteFrame","diamondsItemImg","propItemImg","giftItemImg","extends","Component","goldPrefab","Prefab","diamondsPrefab","propPrefab","giftPrefab","shopScrollView","type","ScrollView","default","glodType","diamondsType","propType","giftType","onLoad","getShopData","get","res","data","JSON","parse","goldData","gold","diamondsData","diamonds","propData","prop","giftData","gift","_gen_Item","console","log","err","bind","goldsPanel","content","removeAllChildren","diamondsPanel","propPanel","giftPanel","prefab","imgType","i","length","shopItem","instantiate","addChild","num","getChildByName","getComponent","Label","string","price","j","imgName","shopItemImg","Sprite","spriteFrame","start"],"mappings":"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","file":"shop.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\Script\\shop","sourcesContent":["\r\nvar global = require(\"globel\");\r\nvar http = require(\"http\");\r\nconst url = global.url;\r\nconst goldItemImg = cc.Class({\r\n    name:\"goldItemImg\",\r\n    properties: {    \r\n        name: '',\r\n        itemSprite: cc.SpriteFrame\r\n    }\r\n});\r\nconst diamondsItemImg = cc.Class({\r\n    name:\"diamondsItemImg\",\r\n    properties: {    \r\n        name: '',\r\n        itemSprite: cc.SpriteFrame\r\n    }\r\n});\r\nconst propItemImg = cc.Class({\r\n    name:\"propItemImg\",\r\n    properties: {    \r\n        name: '',\r\n        itemSprite: cc.SpriteFrame\r\n    }\r\n});\r\nconst giftItemImg = cc.Class({\r\n    name:\"giftItemImg\",\r\n    properties: {    \r\n        name: '',\r\n        itemSprite: cc.SpriteFrame\r\n    }\r\n});\r\n\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        goldPrefab:cc.Prefab,\r\n        diamondsPrefab:cc.Prefab,\r\n        propPrefab:cc.Prefab,\r\n        giftPrefab:cc.Prefab,\r\n        \r\n        shopScrollView:{\r\n            type:cc.ScrollView,\r\n            default:null\r\n        },\r\n        glodType:{\r\n            type:goldItemImg,\r\n            default:[]\r\n        },\r\n        diamondsType:{\r\n            type:diamondsItemImg,\r\n            default:[]\r\n        },\r\n        propType:{\r\n            type:propItemImg,\r\n            default:[]\r\n        },\r\n        giftType:{\r\n            type:giftItemImg,\r\n            default:[]\r\n        }\r\n    },\r\n\r\n    // LIFE-CYCLE CALLBACKS:\r\n\r\n    onLoad () {\r\n    //    this._gen_goldItem();\r\n       this.getShopData();\r\n    },\r\n    // mock数据\r\n    getShopData:function(){\r\n        http.get(url+'jsonTest/shop_test.json',function(res){\r\n            if(res){\r\n                let data = JSON.parse(res);\r\n                this.goldData = data.gold;\r\n                this.diamondsData = data.diamonds;\r\n                this.propData = data.prop;\r\n                this.giftData = data.gift;\r\n                this._gen_Item(this.goldData,this.goldPrefab,this.glodType);\r\n                \r\n            }else{\r\n                console.log(err);\r\n                return;\r\n            }\r\n        }.bind(this));\r\n    },\r\n    goldsPanel:function(){\r\n        this.shopScrollView.content.removeAllChildren();\r\n        this._gen_Item(this.goldData,this.goldPrefab,this.glodType);\r\n    },\r\n    diamondsPanel:function(){\r\n        this.shopScrollView.content.removeAllChildren();\r\n        this._gen_Item(this.diamondsData,this.diamondsPrefab,this.diamondsType);\r\n    },\r\n   \r\n    propPanel:function(){\r\n        this.shopScrollView.content.removeAllChildren();\r\n        this._gen_Item(this.propData,this.propPrefab,this.propType);\r\n    },\r\n    giftPanel:function(){\r\n        this.shopScrollView.content.removeAllChildren();  \r\n        this._gen_Item(this.giftData,this.giftPrefab,this.giftType);\r\n    },\r\n    // 通用\r\n    _gen_Item:function(data,prefab,imgType){\r\n        for(var i = 0;i < data.length;i++){\r\n            let shopItem = cc.instantiate(prefab); // 复制金币预制体\r\n            this.shopScrollView.content.addChild(shopItem);  // 添加到节点上 \r\n           \r\n            if(data != this.giftData){\r\n                let num = shopItem.getChildByName('name').getChildByName('num');\r\n                num.getComponent(cc.Label).string = data[i].num;\r\n            }\r\n            let price = shopItem.getChildByName('priceBg').getChildByName('price');\r\n            price.getComponent(cc.Label).string = data[i].price;\r\n\r\n            for(var j = 0;j<imgType.length;j++){\r\n                if(imgType[j].name ==  data[i].imgName){\r\n                    let shopItemImg = shopItem.getChildByName('img'); // 获取图片节点\r\n                    shopItemImg.getComponent(cc.Sprite).spriteFrame = imgType[j].itemSprite; \r\n                }\r\n            }\r\n        }\r\n    },\r\n    start () {\r\n\r\n    },\r\n\r\n    // update (dt) {},\r\n});\r\n"]}