{"version":3,"sources":["clipCollider.js"],"names":["globel","require","prop","cc","Class","name","properties","id","itemName","iconSF","SpriteFrame","extends","Component","pigPrefab","type","Prefab","default","pandaPrefab","bearPrefab","clipdollsRoot","Node","bg_bottom0","bg_bottom1","ToolsSpriteFrame","onLoad","director","getCollisionManager","enabled","collider","onCollisionEnter","other","self","_this","dolls","node","children","Clipdolls","active","parent","childName","clipdollsChild","prizeName","getChildByName","getComponent","Label","string","scheduleOnce","siteNum","new_dolls","instantiate","addChild","newDolls","brand","wallet","gold","destroy","g","Sprite","spriteFrame","width","winSize","time","start"],"mappings":"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","file":"clipCollider.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\Script\\game","sourcesContent":["var globel = require(\"globel\");\r\n\r\nvar prop = cc.Class({ // 道具\r\n    name: 'prop',\r\n    properties: {\r\n        id: 0,\r\n        itemName: '',\r\n        iconSF: cc.SpriteFrame\r\n    }\r\n});\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        pigPrefab:{\r\n            type:cc.Prefab,\r\n            default:null\r\n        },\r\n        pandaPrefab:{\r\n            type:cc.Prefab,\r\n            default:null\r\n        },\r\n        bearPrefab:{\r\n            type:cc.Prefab,\r\n            default:null\r\n        },\r\n        clipdollsRoot:{\r\n            type:cc.Node,\r\n            default:null\r\n        },\r\n        bg_bottom0:{\r\n            type:cc.Node,\r\n            default:null\r\n        },\r\n        bg_bottom1:{\r\n            type:cc.Node,\r\n            default:null\r\n        },\r\n        ToolsSpriteFrame:{\r\n            type:prop,\r\n            default:[]\r\n        }\r\n        // clipCount:0\r\n    },\r\n\r\n\r\n    onLoad () {\r\n        cc.director.getCollisionManager().enabled = true;\r\n        // cc.director.getCollisionManager().enabledDebugDraw = true;\r\n        // cc.director.getCollisionManager().enabledDrawBoundingBox = true;\r\n        this.collider = false;\r\n    },\r\n    onCollisionEnter:function (other, self) {\r\n        this.collider = true;\r\n        var _this = this;\r\n        var dolls = other.node.children;\r\n        this.Clipdolls = dolls[0];\r\n        this.bg_bottom1.active = false; // 轨道上下层级关系切换\r\n        this.bg_bottom0.active = true;\r\n        this.Clipdolls.parent = this.clipdollsRoot; // 夹到的娃娃放到夹子下面\r\n        // 复制多一个节点加入原父级\r\n        let childName = this.Clipdolls.children[0].name; // 查看是礼品还是钱包还是金币;\r\n        let clipdollsChild = this.Clipdolls.children[0]; // 被夹中娃娃的礼品存放节点\r\n        // 查看是什么礼品\r\n        switch(childName){\r\n            case \"brand\":this.prizeName = clipdollsChild.getChildByName(\"prizeName\").getComponent(cc.Label).string;break;\r\n            case \"gold\":this.prizeName = clipdollsChild.getChildByName(\"goldNum\").getComponent(cc.Label).string;break;\r\n            case \"wallet\":this.prizeName = clipdollsChild.getChildByName(\"bean\").getComponent(cc.Label).string;break;\r\n        }\r\n        globel.prizeName = this.prizeName; // 把奖品赋值给全局变量;\r\n        this.scheduleOnce(function(){\r\n            if(globel.siteNum == 1){\r\n                var new_dolls = cc.instantiate(this.pigPrefab);\r\n            }\r\n            else if(globel.siteNum == 2){\r\n                var new_dolls = cc.instantiate(this.pandaPrefab);\r\n            }\r\n            else if(globel.siteNum == 3){\r\n                var new_dolls = cc.instantiate(this.bearPrefab);\r\n            }\r\n            other.node.addChild(new_dolls);\r\n            let newDolls = other.node.children[0];\r\n            let brand = newDolls.getChildByName(\"brand\");       // 礼品节点，放置奖品图          \r\n            let wallet = newDolls.getChildByName(\"wallet\");     // 钱包节点，放置金币等\r\n            let gold = newDolls.getChildByName(\"gold\");       // 话费节点，放置话费\r\n            switch(childName){\r\n                case 'brand':wallet.destroy();gold.destroy();\r\n                            for (var g in _this.ToolsSpriteFrame){\r\n                                // if(_this.prizeName  == _this.ToolsSpriteFrame[g].itemName){\r\n                                    brand.children[0].getComponent(cc.Sprite).spriteFrame = _this.ToolsSpriteFrame[g].iconSF;\r\n                                    // brand.children[1].getComponent(cc.Label).string = _this.ToolsSpriteFrame[g].itemName;\r\n                                    brand.children[1].getComponent(cc.Label).string = globel.prizeName;\r\n                                // }\r\n                            }         \r\n                            break;\r\n                case 'gold':wallet.destroy();brand.destroy();\r\n                            gold.children[0].getComponent(cc.Label).string = _this.prizeName;break;\r\n                case 'wallet':brand.destroy();gold.destroy();\r\n                            wallet.children[0].getComponent(cc.Label).string = _this.prizeName;break;  \r\n            }\r\n            other.node.active = false;\r\n        },0.1); //以上目的为复制一个跟被夹走的娃娃一模一样的节点\r\n        let width = cc.winSize.width;\r\n        if(width <1281){\r\n            var time = 6.7; \r\n        }\r\n        else{\r\n            var time = 8; \r\n        }\r\n        this.scheduleOnce(function(){\r\n            other.node.active = true;\r\n        },time);\r\n    },\r\n    start () {\r\n\r\n    },\r\n\r\n    // update (dt) {},\r\n});"]}